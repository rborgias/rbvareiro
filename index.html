<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <title>Distribuição espacial</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: Arial, sans-serif;
            overflow-x: hidden; /* Impede rolagem horizontal na página */
        }
        
        #map { 
            position: absolute; 
            top: 0; 
            bottom: 0; 
            left: 0; 
            right: 261px; /* Aumentado de 250px para 261px (0.3cm a mais) */
            background: #f8f9fa;
        }
        
        /* Sidebar fixa */
        #sidebar {
            position: absolute;
            top: 0;
            right: 0;
            width: 261px; /* Aumentado de 250px para 261px (0.3cm a mais) */
            height: 100%;
            background: #ffffff;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            overflow-y: auto;
            overflow-x: hidden; /* Remove rolagem horizontal */
            padding: 15px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        
        /* Container para os controles de camada */
        .layer-controls-container {
            flex-grow: 1;
            overflow-y: auto;
            overflow-x: hidden; /* Remove rolagem horizontal */
            display: flex;
            flex-direction: column-reverse;
            width: 100%; /* Garante que ocupa toda a largura */
        }
        
        /* Titulo do mapa com logo */
        .map-title-container {
            position: absolute;
            top: 10px;
            left: 40%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .map-logo {
            width: 24px;
            height: 24px;
            background: #3388ff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .map-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }

        .sidebar-header {
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeaea;
            margin-bottom: 15px;
        }
        
        .sidebar-header h3 {
            margin: 0;
            font-size: 16px;
            color: #333;
            font-weight: 600;
            display: flex;
            align-items: center;
            white-space: nowrap; /* Impede quebra de linha */
            overflow: hidden; /* Esconde conteúdo que ultrapasse */
            text-overflow: ellipsis; /* Adiciona "..." se o texto for muito longo */
        }
        
        .sidebar-header i {
            margin-right: 10px;
            color: #3388ff;
        }
        
        .layer-control {
            margin-bottom: 12px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            width: 100%; /* Garante que ocupa toda a largura */
            box-sizing: border-box; /* Inclui padding na largura */
        }
        
        .layer-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            width: 100%;
        }
        
        .layer-checkbox {
            margin-right: 8px;
            cursor: pointer;
            flex-shrink: 0; /* Impede que o checkbox diminua */
        }
        
        .layer-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            flex-grow: 1;
            min-width: 0; /* Permite que o texto seja truncado */
        }
        
        .layer-symbol {
            flex-shrink: 0; /* Impede que o símbolo diminua */
        }
        
        .layer-symbol svg {
            vertical-align: middle;
            margin-right: 8px;
        }
        
        .layer-name {
            font-size: 14px;
            color: #555;
            white-space: normal; /* Permite quebra de linha */
            word-break: break-word; /* Quebra palavras longas */
            overflow-wrap: break-word; /* Quebra palavras longas */
        }
        
        wbr {
            display: inline-block;
        }
        
        .layer-label:hover .layer-name {
            color: #333;
        }
        
        .feature-list-container {
            margin-top: 8px;
            margin-left: 25px;
            width: calc(100% - 25px);
            box-sizing: border-box;
        }
        
        .filter-input {
            padding: 5px;
            margin-bottom: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 12px;
            width: calc(100% - 8px);
            box-sizing: border-box;
        }
        
        .filter-input:focus {
            outline: none;
            border-color: #3388ff;
            box-shadow: 0 0 0 2px rgba(51, 136, 255, 0.2);
        }
        
        .feature-list {
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 4px;
            font-size: 12px;
            background: #f9f9f9;
            max-height: 120px;
            overflow-y: auto;
            width: calc(100% - 8px);
            box-sizing: border-box;
        }
        
        .feature-list option {
            padding: 2px 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .feature-list option:hover {
            background-color: #e9e9e9;
        }
        
        .clear-button {
            background-color: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
            border-radius: 3px;
            cursor: pointer;
            margin-top: 5px;
            width: calc(100% - 8px);
            padding: 3px;
            font-size: 12px;
            box-sizing: border-box;
        }
        
        .clear-button:hover {
            background-color: #e9ecef;
        }

        /* Estilo para tooltip alinhado */
        .aligned-tooltip {
            font-family: Arial;
            white-space: pre;
        }

        /* Melhoria para cursor interativo */
        .leaflet-interactive {
            cursor: default;
        }
    </style>
</head>
<body>
    <!-- Sidebar fixa -->
    <div id="sidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-layer-group"></i> Controle de Camadas</h3>
        </div>
        
        <!-- Container para controles com ordem inversa visual -->
        <div class="layer-controls-container">
            <!-- Controle do mapa base (se habilitado) -->
            
            <div class="layer-control">
                <div class="layer-header">
                    <input type="checkbox" id="base-layer-checkbox" class="layer-checkbox" checked>
                    <label for="base-layer-checkbox" class="layer-label">
                        <span class="layer-name">OpenStreetMap</span>
                    </label>
                </div>
            </div>
            
            
            <!-- Controles para todas as camadas -->
            
            <div class="layer-control" data-layer-index="0">
                <div class="layer-header">
                    <input type="checkbox" id="layer-checkbox-0" class="layer-checkbox" checked>
                    <label for="layer-checkbox-0" class="layer-label">
                        <span class="layer-symbol">
            <svg width="16" height="16" viewBox="0 0 16 16" style="margin-right: 8px;">
                <rect x="3" y="3" width="10" height="10" fill="#ffffff" opacity="0.0" 
                      stroke="#ea0004" stroke-width="1.89" stroke-opacity="1.0"/>
            </svg></span>
                        <span class="layer-name" title="raio_100km">raio_100km</span>
                    </label>
                </div>
            </div>
            <div class="layer-control" data-layer-index="1">
                <div class="layer-header">
                    <input type="checkbox" id="layer-checkbox-1" class="layer-checkbox" checked>
                    <label for="layer-checkbox-1" class="layer-label">
                        <span class="layer-symbol">
            <svg width="16" height="16" viewBox="0 0 16 16" style="margin-right: 8px;">
                <rect x="3" y="3" width="10" height="10" fill="#f2ff01" opacity="0.0" 
                      stroke="#ffff01" stroke-width="1.89" stroke-opacity="1.0"/>
            </svg></span>
                        <span class="layer-name" title="raio_50km_reproj">raio_50km_reproj</span>
                    </label>
                </div>
            </div>
            <div class="layer-control" data-layer-index="2">
                <div class="layer-header">
                    <input type="checkbox" id="layer-checkbox-2" class="layer-checkbox" checked>
                    <label for="layer-checkbox-2" class="layer-label">
                        <span class="layer-symbol">
            <svg width="16" height="16" viewBox="0 0 16 16" style="margin-right: 8px;">
                <rect x="3" y="3" width="10" height="10" fill="#987db7" opacity="0.0" 
                      stroke="#23ff01" stroke-width="1.89" stroke-opacity="1.0"/>
            </svg></span>
                        <span class="layer-name" title="raio_25km_reproj">raio_25km_reproj</span>
                    </label>
                </div>
            </div>
        <div class="layer-control" data-layer-index="3">
            <div class="layer-header">
                <input type="checkbox" id="layer-checkbox-3" class="layer-checkbox" checked>
                <label for="layer-checkbox-3" class="layer-label">
                    <span class="layer-symbol">
                <svg width="16" height="16" viewBox="0 0 16 16" style="margin-right: 8px;">
                    <circle cx="8" cy="8" r="5.292" fill="#8d5a99" opacity="1.0" 
                            stroke="#8d5a99" stroke-width="0.5" stroke-opacity="1.0"/>
                </svg></span>
                    <span class="layer-name" title="prods_100km (matricula)">prods_100km<wbr> (matricula)</span>
                </label>
            </div>
            
            <div class="feature-list-container">
                <input type="text" id="filter-3" class="filter-input" 
                       placeholder="Filtrar itens..." style="width: calc(100% - 8px); margin-bottom: 5px;">
                
                <select id="feature-list-3" class="feature-list" multiple size="4" style="width: calc(100% - 8px);">
                    <option value="1111">1111</option><option value="11255">11255</option><option value="11879">11879</option><option value="119842">119842</option><option value="121365">121365</option><option value="1222">1222</option><option value="12348">12348</option><option value="124789">124789</option><option value="12874">12874</option><option value="13245">13245</option><option value="134671">134671</option><option value="134679">134679</option><option value="137946">137946</option><option value="14847">14847</option><option value="14987">14987</option><option value="15498">15498</option><option value="161616">161616</option><option value="1645">1645</option><option value="1648">1648</option><option value="168895">168895</option><option value="1894">1894</option><option value="18979">18979</option><option value="189798">189798</option><option value="195">195</option><option value="195946">195946</option><option value="197">197</option><option value="197315">197315</option><option value="19789">19789</option><option value="197892">197892</option><option value="1987">1987</option><option value="248798">248798</option><option value="248949">248949</option><option value="2598">2598</option><option value="26154">26154</option><option value="2649822">2649822</option><option value="26595">26595</option><option value="2699">2699</option><option value="294598">294598</option><option value="29696">29696</option><option value="2982">2982</option><option value="346">346</option><option value="4513">4513</option><option value="456789">456789</option><option value="45826">45826</option><option value="46562">46562</option><option value="47789">47789</option><option value="4789">4789</option><option value="482675">482675</option><option value="489">489</option><option value="4894632">4894632</option><option value="4896">4896</option><option value="4942">4942</option><option value="52329">52329</option><option value="537589">537589</option><option value="54898">54898</option><option value="55548">55548</option><option value="55956">55956</option><option value="5615">5615</option><option value="62295">62295</option><option value="6488">6488</option><option value="66565">66565</option><option value="666334">666334</option><option value="74182">74182</option><option value="7419">7419</option><option value="765413">765413</option><option value="781245">781245</option><option value="7845">7845</option><option value="7894">7894</option><option value="78941">78941</option><option value="794628">794628</option><option value="798461">798461</option><option value="82496">82496</option><option value="895523">895523</option><option value="89898">89898</option><option value="934">934</option><option value="94561">94561</option><option value="94981">94981</option><option value="952">952</option><option value="958416">958416</option><option value="9635">9635</option><option value="96418">96418</option><option value="96621">96621</option><option value="98465">98465</option><option value="985246">985246</option><option value="985623">985623</option><option value="989464">989464</option><option value="99554">99554</option><option value="99654">99654</option>
                </select>
                
                <button id="clear-selection-3" class="clear-button" 
                        style="margin-top: 5px; width: calc(100% - 8px); padding: 3px; font-size: 12px;">
                    Limpar seleção
                </button>
            </div>
        </div>
        <div class="layer-control" data-layer-index="4">
            <div class="layer-header">
                <input type="checkbox" id="layer-checkbox-4" class="layer-checkbox" checked>
                <label for="layer-checkbox-4" class="layer-label">
                    <span class="layer-symbol">
                <svg width="16" height="16" viewBox="0 0 16 16" style="margin-right: 8px;">
                    <circle cx="8" cy="8" r="5.292" fill="#09ff01" opacity="1.0" 
                            stroke="#09ff01" stroke-width="0.5" stroke-opacity="1.0"/>
                </svg></span>
                    <span class="layer-name" title="prods_50km_reproj (matricula)">prods_50km_reproj<wbr> (matricula)</span>
                </label>
            </div>
            
            <div class="feature-list-container">
                <input type="text" id="filter-4" class="filter-input" 
                       placeholder="Filtrar itens..." style="width: calc(100% - 8px); margin-bottom: 5px;">
                
                <select id="feature-list-4" class="feature-list" multiple size="4" style="width: calc(100% - 8px);">
                    <option disabled>Nenhum valor encontrado</option>
                </select>
                
                <button id="clear-selection-4" class="clear-button" 
                        style="margin-top: 5px; width: calc(100% - 8px); padding: 3px; font-size: 12px;">
                    Limpar seleção
                </button>
            </div>
        </div>
        <div class="layer-control" data-layer-index="5">
            <div class="layer-header">
                <input type="checkbox" id="layer-checkbox-5" class="layer-checkbox" checked>
                <label for="layer-checkbox-5" class="layer-label">
                    <span class="layer-symbol">
                <svg width="16" height="16" viewBox="0 0 16 16" style="margin-right: 8px;">
                    <circle cx="8" cy="8" r="5.292" fill="#ff9e17" opacity="1.0" 
                            stroke="#ff9e17" stroke-width="0.5" stroke-opacity="1.0"/>
                </svg></span>
                    <span class="layer-name" title="prods_25m_reproj (matricula)">prods_25m_reproj<wbr> (matricula)</span>
                </label>
            </div>
            
            <div class="feature-list-container">
                <input type="text" id="filter-5" class="filter-input" 
                       placeholder="Filtrar itens..." style="width: calc(100% - 8px); margin-bottom: 5px;">
                
                <select id="feature-list-5" class="feature-list" multiple size="4" style="width: calc(100% - 8px);">
                    <option value="11102">11102</option><option value="12311">12311</option><option value="12345">12345</option><option value="1238">1238</option><option value="142541">142541</option><option value="14593">14593</option><option value="210365">210365</option><option value="21312">21312</option><option value="216574">216574</option><option value="254971">254971</option><option value="31999">31999</option><option value="326478">326478</option><option value="32659">32659</option><option value="33321">33321</option><option value="33325">33325</option><option value="384095">384095</option><option value="451233">451233</option><option value="45564">45564</option><option value="45622">45622</option><option value="456701">456701</option><option value="4569">4569</option><option value="45697">45697</option><option value="46821">46821</option><option value="49715">49715</option><option value="5612">5612</option><option value="58401">58401</option><option value="66218">66218</option><option value="69999">69999</option><option value="719813">719813</option><option value="744489">744489</option><option value="75316">75316</option><option value="76136">76136</option><option value="77741">77741</option><option value="78312">78312</option><option value="78451">78451</option><option value="7894">7894</option><option value="78941">78941</option><option value="78944">78944</option><option value="78955">78955</option><option value="78999">78999</option><option value="84458">84458</option><option value="852014">852014</option><option value="96325">96325</option><option value="96635">96635</option><option value="99874">99874</option><option value="99954">99954</option>
                </select>
                
                <button id="clear-selection-5" class="clear-button" 
                        style="margin-top: 5px; width: calc(100% - 8px); padding: 3px; font-size: 12px;">
                    Limpar seleção
                </button>
            </div>
        </div>
        </div>
    </div>
    
    <!-- Mapa -->
    <div id="map"></div>
    
    <!-- Titulo do mapa com logo -->
    <div class="map-title-container">
        <div class="map-logo">L</div>
        <div class="map-title">Distribuição espacial</div>
    </div>
    
    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // Inicializa o mapa
        var map = L.map('map').setView([0, 0], 2);
        
        // Mapa base (se habilitado)
        
        var baseLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);
        
        // Controle do mapa base
        document.getElementById('base-layer-checkbox').addEventListener('change', function(e) {
            e.target.checked ? map.addLayer(baseLayer) : map.removeLayer(baseLayer);
        });
        
        
        // Adiciona todas as camadas
        
        // Camada 0: raio_100km
        var layer0 = L.geoJSON({"features":[{"bbox":[-53.718062,-28.000536,-51.701516,-26.19565],"geometry":{"coordinates":[[[[-51.701516,-27.10681],[-51.703861,-27.163486],[-51.710186,-27.219917],[-51.72047,-27.275881],[-51.73468,-27.331155],[-51.752764,-27.38552],[-51.774657,-27.43876],[-51.800275,-27.490663],[-51.829524,-27.541022],[-51.86229,-27.589636],[-51.898447,-27.63631],[-51.937855,-27.680859],[-51.980359,-27.723102],[-52.025792,-27.762871],[-52.073975,-27.800006],[-52.124716,-27.834358],[-52.177814,-27.865788],[-52.233057,-27.89417],[-52.290222,-27.91939],[-52.349081,-27.941345],[-52.409396,-27.959948],[-52.470924,-27.975123],[-52.533418,-27.986809],[-52.596624,-27.994959],[-52.660286,-27.999541],[-52.724148,-28.000536],[-52.78795,-27.99794],[-52.851435,-27.991764],[-52.914346,-27.982033],[-52.976428,-27.968788],[-53.037432,-27.952082],[-53.097111,-27.931982],[-53.155225,-27.908571],[-53.211542,-27.881942],[-53.265835,-27.852204],[-53.317888,-27.819477],[-53.367494,-27.783892],[-53.414457,-27.745594],[-53.45859,-27.704735],[-53.499721,-27.66148],[-53.537689,-27.616002],[-53.572345,-27.568483],[-53.603558,-27.519114],[-53.631206,-27.46809],[-53.655185,-27.415616],[-53.675406,-27.361901],[-53.691793,-27.307156],[-53.704288,-27.2516],[-53.712847,-27.195452],[-53.717443,-27.138934],[-53.718062,-27.08227],[-53.71471,-27.025681],[-53.707405,-26.969392],[-53.696181,-26.913623],[-53.681088,-26.858593],[-53.66219,-26.804517],[-53.639568,-26.751607],[-53.613314,-26.70007],[-53.583534,-26.650107],[-53.55035,-26.601913],[-53.513894,-26.555675],[-53.474312,-26.511574],[-53.431761,-26.469781],[-53.386408,-26.430458],[-53.338432,-26.393758],[-53.28802,-26.359823],[-53.235371,-26.328786],[-53.180687,-26.300767],[-53.124183,-26.275873],[-53.066078,-26.254202],[-53.006595,-26.235838],[-52.945967,-26.220852],[-52.884425,-26.209302],[-52.822209,-26.201233],[-52.759558,-26.196677],[-52.696714,-26.19565],[-52.633919,-26.198159],[-52.571416,-26.204192],[-52.509445,-26.213728],[-52.448246,-26.226729],[-52.388055,-26.243146],[-52.329107,-26.262916],[-52.271628,-26.285961],[-52.215842,-26.312193],[-52.161967,-26.341511],[-52.110212,-26.373802],[-52.060779,-26.408939],[-52.013864,-26.446788],[-51.96965,-26.487201],[-51.928311,-26.530021],[-51.890013,-26.575081],[-51.854908,-26.622207],[-51.823136,-26.671214],[-51.794827,-26.721912],[-51.770094,-26.774101],[-51.749041,-26.827579],[-51.731754,-26.882135],[-51.718307,-26.937555],[-51.708759,-26.993621],[-51.703152,-27.050114],[-51.701516,-27.10681]]]],"type":"MultiPolygon"},"id":0,"properties":{"id":0,"x":330463.0,"y":7001540.0},"type":"Feature"}],"type":"FeatureCollection"}, {
            style: function(feature) {
                return {
                    color: '#ea0004',
                    weight: 1.89,
                    opacity: 1.0,
                    fillColor: '#ffffff',
                    fillOpacity: 0.0
                };
            },
            
            onEachFeature: function(feature, layer) {
                // Verifica se existem propriedades (para GeoJSON)
                var props = feature.properties || feature;
                
                if (props) {
                    // Ordena os nomes dos atributos
                    var propNames = Object.keys(props).sort();
                    
                    // Cria conteúdo formatado no padrão atributo: valor (um por linha)
                    var content = "<div style='font-family: Arial;'>";
                    for (var i = 0; i < propNames.length; i++) {
                        var prop = propNames[i];
                        var value = props[prop] !== null && props[prop] !== undefined ? props[prop] : '';
                        content += "<b>" + prop + "</b>: " + value + "<br>";
                    }
                    content += "</div>";
                    
                    // Adiciona popup ao clicar
                    layer.bindPopup(content);
                    
                    // Armazena o valor do atributo selecionado (se houver)
                    if ('None' && props['None'] !== undefined) {
                        layer.featureAttrValue = String(props['None']);
                    }
                    
                    // Armazena o estilo original
                    layer._originalStyle = {
                        color: '#ea0004',
                        weight: 1.89,
                        opacity: 1.0,
                        fillColor: '#ffffff',
                        fillOpacity: 0.0,
                        radius: 5
                    };
                    
                    // Armazena se está selecionado
                    layer._isSelected = false;
                }
            }
        });
        
        // Adiciona a camada ao mapa
        layer0.addTo(map);
        
        // Controle da camada 0
        document.getElementById('layer-checkbox-0').addEventListener('change', function(e) {
            if (e.target.checked) {
                layer0.addTo(map);
            } else {
                map.removeLayer(layer0);
            }
            reorderLayers();
        });
        // Camada 1: raio_50km_reproj
        var layer1 = L.geoJSON({"features":[{"bbox":[-53.21419,-27.54936,-52.205869,-26.646917],"geometry":{"coordinates":[[[[-52.205869,-27.103387],[-52.209139,-27.150539],[-52.217907,-27.197126],[-52.232082,-27.242636],[-52.251516,-27.28657],[-52.276001,-27.328442],[-52.305272,-27.367793],[-52.339011,-27.404187],[-52.376849,-27.437223],[-52.418372,-27.466536],[-52.463122,-27.491802],[-52.510606,-27.512741],[-52.5603,-27.529121],[-52.611653,-27.540761],[-52.664096,-27.547532],[-52.717047,-27.54936],[-52.76992,-27.546225],[-52.822128,-27.538161],[-52.873093,-27.525258],[-52.922249,-27.50766],[-52.969054,-27.485562],[-53.012992,-27.459209],[-53.053578,-27.428893],[-53.090368,-27.394949],[-53.122958,-27.357751],[-53.150994,-27.317711],[-53.174173,-27.27527],[-53.192245,-27.230895],[-53.205017,-27.185073],[-53.212357,-27.138309],[-53.21419,-27.091114],[-53.210504,-27.044006],[-53.201345,-26.9975],[-53.186821,-26.952104],[-53.167096,-26.908313],[-53.14239,-26.866605],[-53.112978,-26.827435],[-53.079185,-26.791227],[-53.04138,-26.758377],[-52.999978,-26.72924],[-52.95543,-26.704134],[-52.908221,-26.683331],[-52.858863,-26.667057],[-52.807893,-26.655488],[-52.755861,-26.648751],[-52.703333,-26.646917],[-52.650877,-26.650009],[-52.59906,-26.657992],[-52.548444,-26.67078],[-52.499579,-26.688235],[-52.452994,-26.710168],[-52.409198,-26.736342],[-52.368666,-26.766471],[-52.331843,-26.80023],[-52.299132,-26.837251],[-52.270894,-26.877131],[-52.24744,-26.919437],[-52.229032,-26.963706],[-52.215877,-27.009456],[-52.208126,-27.056187],[-52.205869,-27.103387]]]],"type":"MultiPolygon"},"id":0,"properties":{"id":0,"x":330463.0,"y":7001540.0},"type":"Feature"}],"type":"FeatureCollection"}, {
            style: function(feature) {
                return {
                    color: '#ffff01',
                    weight: 1.89,
                    opacity: 1.0,
                    fillColor: '#f2ff01',
                    fillOpacity: 0.0
                };
            },
            
            onEachFeature: function(feature, layer) {
                // Verifica se existem propriedades (para GeoJSON)
                var props = feature.properties || feature;
                
                if (props) {
                    // Ordena os nomes dos atributos
                    var propNames = Object.keys(props).sort();
                    
                    // Cria conteúdo formatado no padrão atributo: valor (um por linha)
                    var content = "<div style='font-family: Arial;'>";
                    for (var i = 0; i < propNames.length; i++) {
                        var prop = propNames[i];
                        var value = props[prop] !== null && props[prop] !== undefined ? props[prop] : '';
                        content += "<b>" + prop + "</b>: " + value + "<br>";
                    }
                    content += "</div>";
                    
                    // Adiciona popup ao clicar
                    layer.bindPopup(content);
                    
                    // Armazena o valor do atributo selecionado (se houver)
                    if ('None' && props['None'] !== undefined) {
                        layer.featureAttrValue = String(props['None']);
                    }
                    
                    // Armazena o estilo original
                    layer._originalStyle = {
                        color: '#ffff01',
                        weight: 1.89,
                        opacity: 1.0,
                        fillColor: '#f2ff01',
                        fillOpacity: 0.0,
                        radius: 5
                    };
                    
                    // Armazena se está selecionado
                    layer._isSelected = false;
                }
            }
        });
        
        // Adiciona a camada ao mapa
        layer1.addTo(map);
        
        // Controle da camada 1
        document.getElementById('layer-checkbox-1').addEventListener('change', function(e) {
            if (e.target.checked) {
                layer1.addTo(map);
            } else {
                map.removeLayer(layer1);
            }
            reorderLayers();
        });
        // Camada 2: raio_25km_reproj
        var layer2 = L.geoJSON({"features":[{"bbox":[-52.962173,-27.323761,-52.458007,-26.87254],"geometry":{"coordinates":[[[[-52.458007,-27.100996],[-52.459694,-27.124568],[-52.464127,-27.147852],[-52.471259,-27.170593],[-52.481013,-27.192542],[-52.493284,-27.213458],[-52.507938,-27.233111],[-52.524815,-27.251285],[-52.543731,-27.267779],[-52.564477,-27.282414],[-52.586827,-27.295026],[-52.610535,-27.305478],[-52.635339,-27.313654],[-52.660967,-27.319465],[-52.687136,-27.322847],[-52.713558,-27.323761],[-52.739942,-27.322199],[-52.765996,-27.318177],[-52.791434,-27.311741],[-52.815976,-27.30296],[-52.839351,-27.291932],[-52.861302,-27.278778],[-52.881589,-27.263644],[-52.899988,-27.246695],[-52.916299,-27.228118],[-52.930344,-27.208118],[-52.941968,-27.186914],[-52.951047,-27.16474],[-52.957482,-27.141837],[-52.961203,-27.118459],[-52.962173,-27.09486],[-52.960382,-27.0713],[-52.955851,-27.048036],[-52.948632,-27.025323],[-52.938805,-27.00341],[-52.926479,-26.982535],[-52.911789,-26.962927],[-52.894899,-26.9448],[-52.875991,-26.928352],[-52.855275,-26.913762],[-52.832975,-26.901189],[-52.809337,-26.890771],[-52.784616,-26.882621],[-52.759084,-26.876828],[-52.733018,-26.873455],[-52.706702,-26.87254],[-52.680422,-26.874091],[-52.654466,-26.878092],[-52.629115,-26.8845],[-52.604646,-26.893245],[-52.581327,-26.904232],[-52.55941,-26.917341],[-52.539137,-26.932428],[-52.520729,-26.949331],[-52.504388,-26.967863],[-52.490293,-26.987824],[-52.4786,-27.008994],[-52.469437,-27.031142],[-52.462907,-27.054026],[-52.459082,-27.077396],[-52.458007,-27.100996]]]],"type":"MultiPolygon"},"id":0,"properties":{"id":0},"type":"Feature"}],"type":"FeatureCollection"}, {
            style: function(feature) {
                return {
                    color: '#23ff01',
                    weight: 1.89,
                    opacity: 1.0,
                    fillColor: '#987db7',
                    fillOpacity: 0.0
                };
            },
            
            onEachFeature: function(feature, layer) {
                // Verifica se existem propriedades (para GeoJSON)
                var props = feature.properties || feature;
                
                if (props) {
                    // Ordena os nomes dos atributos
                    var propNames = Object.keys(props).sort();
                    
                    // Cria conteúdo formatado no padrão atributo: valor (um por linha)
                    var content = "<div style='font-family: Arial;'>";
                    for (var i = 0; i < propNames.length; i++) {
                        var prop = propNames[i];
                        var value = props[prop] !== null && props[prop] !== undefined ? props[prop] : '';
                        content += "<b>" + prop + "</b>: " + value + "<br>";
                    }
                    content += "</div>";
                    
                    // Adiciona popup ao clicar
                    layer.bindPopup(content);
                    
                    // Armazena o valor do atributo selecionado (se houver)
                    if ('None' && props['None'] !== undefined) {
                        layer.featureAttrValue = String(props['None']);
                    }
                    
                    // Armazena o estilo original
                    layer._originalStyle = {
                        color: '#23ff01',
                        weight: 1.89,
                        opacity: 1.0,
                        fillColor: '#987db7',
                        fillOpacity: 0.0,
                        radius: 5
                    };
                    
                    // Armazena se está selecionado
                    layer._isSelected = false;
                }
            }
        });
        
        // Adiciona a camada ao mapa
        layer2.addTo(map);
        
        // Controle da camada 2
        document.getElementById('layer-checkbox-2').addEventListener('change', function(e) {
            if (e.target.checked) {
                layer2.addTo(map);
            } else {
                map.removeLayer(layer2);
            }
            reorderLayers();
        });
        // Camada 3: prods_100km
        var layer3 = L.geoJSON({"features":[{"geometry":{"coordinates":[-53.246177,-27.00713],"type":"Point"},"id":0,"properties":{"filiada":"Alfa","id":null,"matricula":12348,"nome":null,"x":-53.246,"y":-27.007},"type":"Feature"},{"geometry":{"coordinates":[-53.256387,-27.041252],"type":"Point"},"id":1,"properties":{"filiada":"Alfa","id":null,"matricula":489,"nome":null,"x":-53.256,"y":-27.041},"type":"Feature"},{"geometry":{"coordinates":[-53.266709,-26.859359],"type":"Point"},"id":2,"properties":{"filiada":"Alfa","id":null,"matricula":4896,"nome":null,"x":-53.266,"y":-26.859},"type":"Feature"},{"geometry":{"coordinates":[-53.305724,-26.825703],"type":"Point"},"id":3,"properties":{"filiada":"Alfa","id":null,"matricula":15498,"nome":null,"x":-53.305,"y":-26.825},"type":"Feature"},{"geometry":{"coordinates":[-53.312413,-26.825743],"type":"Point"},"id":4,"properties":{"filiada":"Alfa","id":null,"matricula":78941,"nome":null,"x":-53.312,"y":-26.825},"type":"Feature"},{"geometry":{"coordinates":[-53.346204,-26.821024],"type":"Point"},"id":5,"properties":{"filiada":"Alfa","id":null,"matricula":346,"nome":null,"x":-53.346,"y":-26.821},"type":"Feature"},{"geometry":{"coordinates":[-53.186325,-26.865445],"type":"Point"},"id":6,"properties":{"filiada":"Alfa","id":null,"matricula":18979,"nome":null,"x":-53.186,"y":-26.865},"type":"Feature"},{"geometry":{"coordinates":[-53.171081,-26.827742],"type":"Point"},"id":7,"properties":{"filiada":"Alfa","id":null,"matricula":1894,"nome":null,"x":-53.171,"y":-26.827},"type":"Feature"},{"geometry":{"coordinates":[-53.179192,-26.788951],"type":"Point"},"id":8,"properties":{"filiada":"Copérdia","id":null,"matricula":489,"nome":null,"x":-53.179,"y":-26.789},"type":"Feature"},{"geometry":{"coordinates":[-53.177764,-26.730715],"type":"Point"},"id":9,"properties":{"filiada":"Alfa","id":null,"matricula":94981,"nome":null,"x":-53.177,"y":-26.73},"type":"Feature"},{"geometry":{"coordinates":[-53.072814,-26.719873],"type":"Point"},"id":10,"properties":{"filiada":"Alfa","id":null,"matricula":1648,"nome":null,"x":-53.072,"y":-26.719},"type":"Feature"},{"geometry":{"coordinates":[-53.08455,-26.720315],"type":"Point"},"id":11,"properties":{"filiada":"Copérdia","id":null,"matricula":54898,"nome":null,"x":-53.084,"y":-26.72},"type":"Feature"},{"geometry":{"coordinates":[-53.103228,-26.66204],"type":"Point"},"id":12,"properties":{"filiada":"Copérdia","id":null,"matricula":98465,"nome":null,"x":-53.103,"y":-26.662},"type":"Feature"},{"geometry":{"coordinates":[-53.184822,-26.694641],"type":"Point"},"id":13,"properties":{"filiada":"Alfa","id":null,"matricula":798461,"nome":null,"x":-53.184,"y":-26.694},"type":"Feature"},{"geometry":{"coordinates":[-53.369003,-26.971092],"type":"Point"},"id":14,"properties":{"filiada":"Copérdia","id":null,"matricula":197,"nome":null,"x":-53.369,"y":-26.971},"type":"Feature"},{"geometry":{"coordinates":[-53.355213,-26.91164],"type":"Point"},"id":15,"properties":{"filiada":"Copérdia","id":null,"matricula":1987,"nome":null,"x":-53.355,"y":-26.911},"type":"Feature"},{"geometry":{"coordinates":[-53.360164,-26.855552],"type":"Point"},"id":16,"properties":{"filiada":"Alfa","id":null,"matricula":197892,"nome":null,"x":-53.36,"y":-26.855},"type":"Feature"},{"geometry":{"coordinates":[-53.410804,-27.067473],"type":"Point"},"id":17,"properties":{"filiada":"Alfa","id":null,"matricula":14987,"nome":null,"x":-53.41,"y":-27.067},"type":"Feature"},{"geometry":{"coordinates":[-53.369757,-26.61076],"type":"Point"},"id":18,"properties":{"filiada":"Alfa","id":null,"matricula":119842,"nome":null,"x":-53.369,"y":-26.61},"type":"Feature"},{"geometry":{"coordinates":[-53.34433,-26.662688],"type":"Point"},"id":19,"properties":{"filiada":"Copérdia","id":null,"matricula":11879,"nome":null,"x":-53.344,"y":-26.662},"type":"Feature"},{"geometry":{"coordinates":[-53.175919,-26.578874],"type":"Point"},"id":20,"properties":{"filiada":"Alfa","id":null,"matricula":13245,"nome":null,"x":-53.175,"y":-26.578},"type":"Feature"},{"geometry":{"coordinates":[-53.085698,-26.59002],"type":"Point"},"id":21,"properties":{"filiada":"Copérdia","id":null,"matricula":7894,"nome":null,"x":-53.085,"y":-26.59},"type":"Feature"},{"geometry":{"coordinates":[-53.07753,-26.609823],"type":"Point"},"id":22,"properties":{"filiada":"Copérdia","id":null,"matricula":1645,"nome":null,"x":-53.077,"y":-26.609},"type":"Feature"},{"geometry":{"coordinates":[-53.536928,-26.96753],"type":"Point"},"id":23,"properties":{"filiada":"Alfa","id":null,"matricula":934,"nome":null,"x":-53.536,"y":-26.967},"type":"Feature"},{"geometry":{"coordinates":[-53.535055,-27.027644],"type":"Point"},"id":24,"properties":{"filiada":"Copérdia","id":null,"matricula":7419,"nome":null,"x":-53.535,"y":-27.027},"type":"Feature"},{"geometry":{"coordinates":[-53.531823,-27.029766],"type":"Point"},"id":25,"properties":{"filiada":"Copérdia","id":null,"matricula":19789,"nome":null,"x":-53.531,"y":-27.029},"type":"Feature"},{"geometry":{"coordinates":[-53.533682,-27.029253],"type":"Point"},"id":26,"properties":{"filiada":"Alfa","id":null,"matricula":952,"nome":null,"x":-53.533,"y":-27.029},"type":"Feature"},{"geometry":{"coordinates":[-53.519641,-26.884323],"type":"Point"},"id":27,"properties":{"filiada":"Alfa","id":null,"matricula":26595,"nome":null,"x":-53.519,"y":-26.884},"type":"Feature"},{"geometry":{"coordinates":[-53.450847,-26.821572],"type":"Point"},"id":28,"properties":{"filiada":"Copérdia","id":null,"matricula":52329,"nome":null,"x":-53.45,"y":-26.821},"type":"Feature"},{"geometry":{"coordinates":[-53.351638,-26.734661],"type":"Point"},"id":29,"properties":{"filiada":"Alfa","id":null,"matricula":46562,"nome":null,"x":-53.351,"y":-26.734},"type":"Feature"},{"geometry":{"coordinates":[-53.458499,-26.72659],"type":"Point"},"id":30,"properties":{"filiada":"Copérdia","id":null,"matricula":2982,"nome":null,"x":-53.458,"y":-26.726},"type":"Feature"},{"geometry":{"coordinates":[-53.146305,-26.579274],"type":"Point"},"id":31,"properties":{"filiada":"Alfa","id":null,"matricula":121365,"nome":null,"x":-53.146,"y":-26.579},"type":"Feature"},{"geometry":{"coordinates":[-53.149133,-26.58457],"type":"Point"},"id":32,"properties":{"filiada":"Copérdia","id":null,"matricula":2598,"nome":null,"x":-53.149,"y":-26.584},"type":"Feature"},{"geometry":{"coordinates":[-52.865977,-26.485053],"type":"Point"},"id":33,"properties":{"filiada":"Alfa","id":null,"matricula":89898,"nome":null,"x":-52.866,"y":-26.485},"type":"Feature"},{"geometry":{"coordinates":[-52.821832,-26.616329],"type":"Point"},"id":34,"properties":{"filiada":"Alfa","id":null,"matricula":66565,"nome":null,"x":-52.821,"y":-26.616},"type":"Feature"},{"geometry":{"coordinates":[-52.744974,-26.623683],"type":"Point"},"id":35,"properties":{"filiada":"Copérdia","id":null,"matricula":989464,"nome":null,"x":-52.745,"y":-26.623},"type":"Feature"},{"geometry":{"coordinates":[-52.756628,-26.604414],"type":"Point"},"id":36,"properties":{"filiada":"Copérdia","id":null,"matricula":62295,"nome":null,"x":-52.756,"y":-26.604},"type":"Feature"},{"geometry":{"coordinates":[-52.654238,-26.549633],"type":"Point"},"id":37,"properties":{"filiada":"Copérdia","id":null,"matricula":2649822,"nome":null,"x":-52.654,"y":-26.549},"type":"Feature"},{"geometry":{"coordinates":[-52.657799,-26.513938],"type":"Point"},"id":38,"properties":{"filiada":"Alfa","id":null,"matricula":99654,"nome":null,"x":-52.657,"y":-26.513},"type":"Feature"},{"geometry":{"coordinates":[-52.614729,-26.526325],"type":"Point"},"id":39,"properties":{"filiada":"Alfa","id":null,"matricula":195,"nome":null,"x":-52.614,"y":-26.526},"type":"Feature"},{"geometry":{"coordinates":[-52.623816,-26.575662],"type":"Point"},"id":40,"properties":{"filiada":"Copérdia","id":null,"matricula":94561,"nome":null,"x":-52.623,"y":-26.575},"type":"Feature"},{"geometry":{"coordinates":[-52.366311,-26.657435],"type":"Point"},"id":41,"properties":{"filiada":"Alfa","id":null,"matricula":985246,"nome":null,"x":-52.366,"y":-26.657},"type":"Feature"},{"geometry":{"coordinates":[-52.466021,-26.689878],"type":"Point"},"id":42,"properties":{"filiada":"Copérdia","id":null,"matricula":765413,"nome":null,"x":-52.466,"y":-26.689},"type":"Feature"},{"geometry":{"coordinates":[-52.372166,-26.695771],"type":"Point"},"id":43,"properties":{"filiada":"Copérdia","id":null,"matricula":161616,"nome":null,"x":-52.372,"y":-26.695},"type":"Feature"},{"geometry":{"coordinates":[-52.364186,-26.694828],"type":"Point"},"id":44,"properties":{"filiada":"Alfa","id":null,"matricula":4513,"nome":null,"x":-52.364,"y":-26.694},"type":"Feature"},{"geometry":{"coordinates":[-52.26777,-26.707142],"type":"Point"},"id":45,"properties":{"filiada":"Alfa","id":null,"matricula":4894632,"nome":null,"x":-52.267,"y":-26.707},"type":"Feature"},{"geometry":{"coordinates":[-52.272329,-26.738384],"type":"Point"},"id":46,"properties":{"filiada":"Copérdia","id":null,"matricula":74182,"nome":null,"x":-52.272,"y":-26.738},"type":"Feature"},{"geometry":{"coordinates":[-52.468576,-26.665981],"type":"Point"},"id":47,"properties":{"filiada":"Alfa","id":null,"matricula":895523,"nome":null,"x":-52.468,"y":-26.666},"type":"Feature"},{"geometry":{"coordinates":[-52.169825,-26.824967],"type":"Point"},"id":48,"properties":{"filiada":"Alfa","id":null,"matricula":11255,"nome":null,"x":-52.169,"y":-26.825},"type":"Feature"},{"geometry":{"coordinates":[-52.961672,-26.45162],"type":"Point"},"id":49,"properties":{"filiada":"Alfa","id":null,"matricula":1111,"nome":null,"x":-52.961,"y":-26.451},"type":"Feature"},{"geometry":{"coordinates":[-53.095343,-26.63542],"type":"Point"},"id":50,"properties":{"filiada":"Copérdia","id":null,"matricula":55956,"nome":null,"x":-53.095,"y":-26.635},"type":"Feature"},{"geometry":{"coordinates":[-52.096606,-26.656042],"type":"Point"},"id":51,"properties":{"filiada":"Copérdia","id":null,"matricula":6488,"nome":null,"x":-52.096,"y":-26.656},"type":"Feature"},{"geometry":{"coordinates":[-52.155441,-26.674849],"type":"Point"},"id":52,"properties":{"filiada":"Alfa","id":null,"matricula":248798,"nome":null,"x":-52.155,"y":-26.674},"type":"Feature"},{"geometry":{"coordinates":[-52.162429,-26.682108],"type":"Point"},"id":53,"properties":{"filiada":"Copérdia","id":null,"matricula":4942,"nome":null,"x":-52.162,"y":-26.682},"type":"Feature"},{"geometry":{"coordinates":[-52.082637,-26.838935],"type":"Point"},"id":54,"properties":{"filiada":"Copérdia","id":null,"matricula":189798,"nome":null,"x":-52.082,"y":-26.838},"type":"Feature"},{"geometry":{"coordinates":[-52.065211,-27.022227],"type":"Point"},"id":55,"properties":{"filiada":"Alfa","id":null,"matricula":47789,"nome":null,"x":-52.065,"y":-27.022},"type":"Feature"},{"geometry":{"coordinates":[-52.038608,-27.030499],"type":"Point"},"id":56,"properties":{"filiada":"Alfa","id":null,"matricula":168895,"nome":null,"x":-52.038,"y":-27.03},"type":"Feature"},{"geometry":{"coordinates":[-52.022522,-27.034953],"type":"Point"},"id":57,"properties":{"filiada":"Alfa","id":null,"matricula":9635,"nome":null,"x":-52.022,"y":-27.035},"type":"Feature"},{"geometry":{"coordinates":[-52.016219,-27.042243],"type":"Point"},"id":58,"properties":{"filiada":"Copérdia","id":null,"matricula":456789,"nome":null,"x":-52.016,"y":-27.042},"type":"Feature"},{"geometry":{"coordinates":[-52.096494,-27.099176],"type":"Point"},"id":59,"properties":{"filiada":"Copérdia","id":null,"matricula":1222,"nome":null,"x":-52.096,"y":-27.099},"type":"Feature"},{"geometry":{"coordinates":[-52.082502,-27.105894],"type":"Point"},"id":60,"properties":{"filiada":"Alfa","id":null,"matricula":4789,"nome":null,"x":-52.082,"y":-27.105},"type":"Feature"},{"geometry":{"coordinates":[-52.079036,-27.108429],"type":"Point"},"id":61,"properties":{"filiada":"Alfa","id":null,"matricula":248949,"nome":null,"x":-52.079,"y":-27.108},"type":"Feature"},{"geometry":{"coordinates":[-52.077736,-27.11279],"type":"Point"},"id":62,"properties":{"filiada":"Alfa","id":null,"matricula":124789,"nome":null,"x":-52.077,"y":-27.112},"type":"Feature"},{"geometry":{"coordinates":[-52.138726,-27.138939],"type":"Point"},"id":63,"properties":{"filiada":"Copérdia","id":null,"matricula":2699,"nome":null,"x":-52.138,"y":-27.138},"type":"Feature"},{"geometry":{"coordinates":[-52.137624,-27.141287],"type":"Point"},"id":64,"properties":{"filiada":"Copérdia","id":null,"matricula":29696,"nome":null,"x":-52.137,"y":-27.141},"type":"Feature"},{"geometry":{"coordinates":[-51.942377,-27.072136],"type":"Point"},"id":65,"properties":{"filiada":"Alfa","id":null,"matricula":666334,"nome":null,"x":-51.942,"y":-27.072},"type":"Feature"},{"geometry":{"coordinates":[-51.923444,-27.071144],"type":"Point"},"id":66,"properties":{"filiada":"Copérdia","id":null,"matricula":294598,"nome":null,"x":-51.923,"y":-27.071},"type":"Feature"},{"geometry":{"coordinates":[-51.976098,-27.111995],"type":"Point"},"id":67,"properties":{"filiada":"Alfa","id":null,"matricula":14847,"nome":null,"x":-51.976,"y":-27.112},"type":"Feature"},{"geometry":{"coordinates":[-51.964071,-27.109246],"type":"Point"},"id":68,"properties":{"filiada":"Copérdia","id":null,"matricula":5615,"nome":null,"x":-51.964,"y":-27.109},"type":"Feature"},{"geometry":{"coordinates":[-51.901584,-27.144872],"type":"Point"},"id":69,"properties":{"filiada":"Alfa","id":null,"matricula":7845,"nome":null,"x":-51.901,"y":-27.144},"type":"Feature"},{"geometry":{"coordinates":[-51.901161,-27.160566],"type":"Point"},"id":70,"properties":{"filiada":"Copérdia","id":null,"matricula":55548,"nome":null,"x":-51.901,"y":-27.16},"type":"Feature"},{"geometry":{"coordinates":[-51.896027,-27.1843],"type":"Point"},"id":71,"properties":{"filiada":"Alfa","id":null,"matricula":99554,"nome":null,"x":-51.896,"y":-27.184},"type":"Feature"},{"geometry":{"coordinates":[-52.103525,-27.222671],"type":"Point"},"id":72,"properties":{"filiada":"Copérdia","id":null,"matricula":96621,"nome":null,"x":-52.103,"y":-27.222},"type":"Feature"},{"geometry":{"coordinates":[-52.069227,-27.191454],"type":"Point"},"id":73,"properties":{"filiada":"Alfa","id":null,"matricula":12874,"nome":null,"x":-52.069,"y":-27.191},"type":"Feature"},{"geometry":{"coordinates":[-52.057066,-27.167591],"type":"Point"},"id":74,"properties":{"filiada":"Copérdia","id":null,"matricula":96418,"nome":null,"x":-52.057,"y":-27.167},"type":"Feature"},{"geometry":{"coordinates":[-52.255209,-26.876813],"type":"Point"},"id":75,"properties":{"filiada":"Alfa","id":null,"matricula":134671,"nome":null,"x":-52.255,"y":-26.876},"type":"Feature"},{"geometry":{"coordinates":[-52.19278,-26.878165],"type":"Point"},"id":76,"properties":{"filiada":"Alfa","id":null,"matricula":195946,"nome":null,"x":-52.192,"y":-26.878},"type":"Feature"},{"geometry":{"coordinates":[-52.226223,-26.889469],"type":"Point"},"id":77,"properties":{"filiada":"Alfa","id":null,"matricula":134679,"nome":null,"x":-52.226,"y":-26.889},"type":"Feature"},{"geometry":{"coordinates":[-52.204017,-26.756696],"type":"Point"},"id":78,"properties":{"filiada":"Copérdia","id":null,"matricula":82496,"nome":null,"x":-52.204,"y":-26.756},"type":"Feature"},{"geometry":{"coordinates":[-52.323384,-26.581777],"type":"Point"},"id":79,"properties":{"filiada":"Alfa","id":null,"matricula":137946,"nome":null,"x":-52.323,"y":-26.581},"type":"Feature"},{"geometry":{"coordinates":[-52.396392,-26.660413],"type":"Point"},"id":80,"properties":{"filiada":"Copérdia","id":null,"matricula":197315,"nome":null,"x":-52.396,"y":-26.66},"type":"Feature"},{"geometry":{"coordinates":[-52.490405,-26.633565],"type":"Point"},"id":81,"properties":{"filiada":"Copérdia","id":null,"matricula":45826,"nome":null,"x":-52.49,"y":-26.633},"type":"Feature"},{"geometry":{"coordinates":[-52.494284,-26.636703],"type":"Point"},"id":82,"properties":{"filiada":"Alfa","id":null,"matricula":794628,"nome":null,"x":-52.494,"y":-26.636},"type":"Feature"},{"geometry":{"coordinates":[-52.104699,-26.918094],"type":"Point"},"id":83,"properties":{"filiada":"Alfa","id":null,"matricula":781245,"nome":null,"x":-52.104,"y":-26.918},"type":"Feature"},{"geometry":{"coordinates":[-52.092362,-26.919123],"type":"Point"},"id":84,"properties":{"filiada":"Copérdia","id":null,"matricula":985623,"nome":null,"x":-52.092,"y":-26.919},"type":"Feature"},{"geometry":{"coordinates":[-52.085574,-26.915718],"type":"Point"},"id":85,"properties":{"filiada":"Alfa","id":null,"matricula":26154,"nome":null,"x":-52.085,"y":-26.915},"type":"Feature"},{"geometry":{"coordinates":[-52.855485,-26.614109],"type":"Point"},"id":86,"properties":{"filiada":"Copérdia","id":null,"matricula":958416,"nome":null,"x":-52.855,"y":-26.614},"type":"Feature"},{"geometry":{"coordinates":[-52.867782,-26.392471],"type":"Point"},"id":87,"properties":{"filiada":"Alfa","id":null,"matricula":482675,"nome":null,"x":-52.867,"y":-26.392},"type":"Feature"},{"geometry":{"coordinates":[-53.076735,-26.779346],"type":"Point"},"id":88,"properties":{"filiada":"Copérdia","id":null,"matricula":537589,"nome":null,"x":-53.076,"y":-26.779},"type":"Feature"}],"type":"FeatureCollection"}, {
            style: function(feature) {
                return {
                    color: '#8d5a99',
                    weight: 2,
                    opacity: 1.0,
                    fillColor: '#8d5a99',
                    fillOpacity: 1.0
                };
            },
            
                pointToLayer: function(feature, latlng) {
                    return L.circleMarker(latlng, {
                        radius: 5.292,
                        fillColor: '#8d5a99',
                        color: '#8d5a99',
                        weight: 1,
                        opacity: 1.0,
                        fillOpacity: 1.0
                    });
                },
            onEachFeature: function(feature, layer) {
                // Verifica se existem propriedades (para GeoJSON)
                var props = feature.properties || feature;
                
                if (props) {
                    // Ordena os nomes dos atributos
                    var propNames = Object.keys(props).sort();
                    
                    // Cria conteúdo formatado no padrão atributo: valor (um por linha)
                    var content = "<div style='font-family: Arial;'>";
                    for (var i = 0; i < propNames.length; i++) {
                        var prop = propNames[i];
                        var value = props[prop] !== null && props[prop] !== undefined ? props[prop] : '';
                        content += "<b>" + prop + "</b>: " + value + "<br>";
                    }
                    content += "</div>";
                    
                    // Adiciona popup ao clicar
                    layer.bindPopup(content);
                    
                    // Armazena o valor do atributo selecionado (se houver)
                    if ('matricula' && props['matricula'] !== undefined) {
                        layer.featureAttrValue = String(props['matricula']);
                    }
                    
                    // Armazena o estilo original
                    layer._originalStyle = {
                        color: '#8d5a99',
                        weight: 2,
                        opacity: 1.0,
                        fillColor: '#8d5a99',
                        fillOpacity: 1.0,
                        radius: 5.292
                    };
                    
                    // Armazena se está selecionado
                    layer._isSelected = false;
                }
            }
        });
        
        // Adiciona a camada ao mapa
        layer3.addTo(map);
        
        // Controle da camada 3
        document.getElementById('layer-checkbox-3').addEventListener('change', function(e) {
            if (e.target.checked) {
                layer3.addTo(map);
            } else {
                map.removeLayer(layer3);
            }
            reorderLayers();
        });
        // Função para destacar features selecionadas 3
        function highlightSelectedFeatures3() {
            var select = document.getElementById('feature-list-3');
            var selectedValues = Array.from(select.selectedOptions).map(option => option.value);
            
            layer3.eachLayer(function(layer) {
                // Verifica se o layer está na seleção
                var isSelected = layer.featureAttrValue && selectedValues.includes(layer.featureAttrValue);
                
                // Atualiza o estado de seleção
                layer._isSelected = isSelected;
                
                if (isSelected) {
                    // Aplica estilo de seleção
                    var highlightStyle = {
                        color: '#ff0000',
                        weight: 4,
                        opacity: 1,
                        fillColor: '#ff0000',
                        fillOpacity: 0.8
                    };
                    if (layer.setStyle) {
                        layer.setStyle(highlightStyle);
                    }
                    if (layer.setRadius) {
                        layer.setRadius(7.292);
                    }
                } else {
                    // Volta ao estilo original
                    if (layer.setStyle && layer._originalStyle) {
                        layer.setStyle(layer._originalStyle);
                    }
                    if (layer.setRadius && layer._originalStyle) {
                        layer.setRadius(layer._originalStyle.radius);
                    }
                }
            });
            
            // Ajusta o zoom para os selecionados
            if (selectedValues.length > 0) {
                var bounds = new L.LatLngBounds();
                layer3.eachLayer(function(layer) {
                    if (layer._isSelected) {
                        if (layer.getBounds) {
                            bounds.extend(layer.getBounds());
                        } else if (layer.getLatLng) {
                            bounds.extend(layer.getLatLng());
                        }
                    }
                });
                if (bounds.isValid()) {
                    map.fitBounds(bounds, { padding: [50, 50] });
                }
            }
        }
        
        // Função para limpar seleção
        function clearSelection3() {
            // 1. Desmarca itens na listbox
            var select = document.getElementById('feature-list-3');
            Array.from(select.options).forEach(option => option.selected = false);
            
            // 2. Remove destaque no mapa
            layer3.eachLayer(function(layer) {
                layer._isSelected = false;
                if (layer.setStyle && layer._originalStyle) {
                    layer.setStyle(layer._originalStyle);
                    if (layer.setRadius) layer.setRadius(layer._originalStyle.radius);
                }
                if (layer.closePopup) layer.closePopup();
            });
        }
        
        // Evento de mudança na listbox
        document.getElementById('feature-list-3').addEventListener('change', highlightSelectedFeatures3);
        
        // Botão de limpar seleção
        document.getElementById('clear-selection-3').addEventListener('click', clearSelection3);
        
        // Camada 4: prods_50km_reproj
        var layer4 = L.geoJSON({"features":[{"geometry":{"coordinates":[-52.65179,-26.81559],"type":"Point"},"id":0,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":335837.3303,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.544092,-26.815853],"type":"Point"},"id":1,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":346542.7519,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.511281,-26.813774],"type":"Point"},"id":2,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":349801.3923,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.325414,-26.925063],"type":"Point"},"id":3,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":368404.7408,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.269025,-26.949381],"type":"Point"},"id":4,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":374030.9819,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.969157,-26.888464],"type":"Point"},"id":5,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":304414.3759,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.000413,-26.899556],"type":"Point"},"id":6,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":301328.5714,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.065811,-27.045338],"type":"Point"},"id":7,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":295096.2222,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.068857,-27.049174],"type":"Point"},"id":8,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":294800.9847,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.108463,-27.074638],"type":"Point"},"id":9,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":290918.8604,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.138754,-27.073117],"type":"Point"},"id":10,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":287911.5203,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.629005,-27.368061],"type":"Point"},"id":11,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":338894.9055,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.555345,-27.339156],"type":"Point"},"id":12,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":346140.7708,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.554413,-27.336716],"type":"Point"},"id":13,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":346229.6408,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.327039,-27.198737],"type":"Point"},"id":14,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":368562.9144,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.333532,-27.209442],"type":"Point"},"id":15,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":367932.3608,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.330938,-27.217524],"type":"Point"},"id":16,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":368198.8213,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.304474,-27.221883],"type":"Point"},"id":17,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":370824.7922,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.367058,-27.248858],"type":"Point"},"id":18,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":364659.4563,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.381755,-27.247885],"type":"Point"},"id":19,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":363203.0841,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.906292,-27.426617],"type":"Point"},"id":20,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":311565.6955,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.015925,-27.294856],"type":"Point"},"id":21,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":300489.8579,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.09848,-27.244397],"type":"Point"},"id":22,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":292223.7056,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.814382,-26.791808],"type":"Point"},"id":23,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":319637.4292,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.900901,-26.813487],"type":"Point"},"id":24,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":311070.8615,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.896479,-26.812986],"type":"Point"},"id":25,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":311509.685,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.019709,-26.834397],"type":"Point"},"id":26,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":299296.7101,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.137587,-26.968809],"type":"Point"},"id":27,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":287831.2386,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.126379,-26.9877],"type":"Point"},"id":28,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":288979.2296,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.144214,-27.005059],"type":"Point"},"id":29,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":287241.5602,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.059932,-27.244258],"type":"Point"},"id":30,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":296041.2311,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.100875,-27.260551],"type":"Point"},"id":31,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":292016.6411,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.562731,-27.413862],"type":"Point"},"id":32,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":345513.8765,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.5662,-27.436718],"type":"Point"},"id":33,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":345202.8067,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.54653,-27.392725],"type":"Point"},"id":34,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":347086.5515,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.545823,-27.391516],"type":"Point"},"id":35,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":347154.8594,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.959561,-26.831137],"type":"Point"},"id":36,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":305269.569,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.944215,-26.744963],"type":"Point"},"id":37,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":306648.8708,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.739003,-26.703273],"type":"Point"},"id":38,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":326997.9542,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.532754,-26.725332],"type":"Point"},"id":39,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":347548.8745,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.310676,-26.865992],"type":"Point"},"id":40,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":369800.5221,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.316318,-26.856856],"type":"Point"},"id":41,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":369229.4641,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.32567,-26.843986],"type":"Point"},"id":42,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":368285.4011,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.339714,-27.136674],"type":"Point"},"id":43,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":367233.9473,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.548671,-26.69175],"type":"Point"},"id":44,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":345920.2886,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.583596,-26.683588],"type":"Point"},"id":45,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":342433.7975,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.694475,-26.679666],"type":"Point"},"id":46,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":331393.8067,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.821744,-26.861914],"type":"Point"},"id":47,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":319016.9326,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.970761,-27.011465],"type":"Point"},"id":48,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":304467.5486,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-52.996671,-27.02173],"type":"Point"},"id":49,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":301914.2669,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.004158,-27.025529],"type":"Point"},"id":50,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":301178.0152,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.109671,-27.144838],"type":"Point"},"id":51,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":290929.6393,"y":null},"type":"Feature"},{"geometry":{"coordinates":[-53.136142,-27.161245],"type":"Point"},"id":52,"properties":{"filiada":null,"id":null,"matricula":null,"nome":null,"x":288336.6275,"y":null},"type":"Feature"}],"type":"FeatureCollection"}, {
            style: function(feature) {
                return {
                    color: '#09ff01',
                    weight: 2,
                    opacity: 1.0,
                    fillColor: '#09ff01',
                    fillOpacity: 1.0
                };
            },
            
                pointToLayer: function(feature, latlng) {
                    return L.circleMarker(latlng, {
                        radius: 5.292,
                        fillColor: '#09ff01',
                        color: '#09ff01',
                        weight: 1,
                        opacity: 1.0,
                        fillOpacity: 1.0
                    });
                },
            onEachFeature: function(feature, layer) {
                // Verifica se existem propriedades (para GeoJSON)
                var props = feature.properties || feature;
                
                if (props) {
                    // Ordena os nomes dos atributos
                    var propNames = Object.keys(props).sort();
                    
                    // Cria conteúdo formatado no padrão atributo: valor (um por linha)
                    var content = "<div style='font-family: Arial;'>";
                    for (var i = 0; i < propNames.length; i++) {
                        var prop = propNames[i];
                        var value = props[prop] !== null && props[prop] !== undefined ? props[prop] : '';
                        content += "<b>" + prop + "</b>: " + value + "<br>";
                    }
                    content += "</div>";
                    
                    // Adiciona popup ao clicar
                    layer.bindPopup(content);
                    
                    // Armazena o valor do atributo selecionado (se houver)
                    if ('matricula' && props['matricula'] !== undefined) {
                        layer.featureAttrValue = String(props['matricula']);
                    }
                    
                    // Armazena o estilo original
                    layer._originalStyle = {
                        color: '#09ff01',
                        weight: 2,
                        opacity: 1.0,
                        fillColor: '#09ff01',
                        fillOpacity: 1.0,
                        radius: 5.292
                    };
                    
                    // Armazena se está selecionado
                    layer._isSelected = false;
                }
            }
        });
        
        // Adiciona a camada ao mapa
        layer4.addTo(map);
        
        // Controle da camada 4
        document.getElementById('layer-checkbox-4').addEventListener('change', function(e) {
            if (e.target.checked) {
                layer4.addTo(map);
            } else {
                map.removeLayer(layer4);
            }
            reorderLayers();
        });
        // Função para destacar features selecionadas 4
        function highlightSelectedFeatures4() {
            var select = document.getElementById('feature-list-4');
            var selectedValues = Array.from(select.selectedOptions).map(option => option.value);
            
            layer4.eachLayer(function(layer) {
                // Verifica se o layer está na seleção
                var isSelected = layer.featureAttrValue && selectedValues.includes(layer.featureAttrValue);
                
                // Atualiza o estado de seleção
                layer._isSelected = isSelected;
                
                if (isSelected) {
                    // Aplica estilo de seleção
                    var highlightStyle = {
                        color: '#ff0000',
                        weight: 4,
                        opacity: 1,
                        fillColor: '#ff0000',
                        fillOpacity: 0.8
                    };
                    if (layer.setStyle) {
                        layer.setStyle(highlightStyle);
                    }
                    if (layer.setRadius) {
                        layer.setRadius(7.292);
                    }
                } else {
                    // Volta ao estilo original
                    if (layer.setStyle && layer._originalStyle) {
                        layer.setStyle(layer._originalStyle);
                    }
                    if (layer.setRadius && layer._originalStyle) {
                        layer.setRadius(layer._originalStyle.radius);
                    }
                }
            });
            
            // Ajusta o zoom para os selecionados
            if (selectedValues.length > 0) {
                var bounds = new L.LatLngBounds();
                layer4.eachLayer(function(layer) {
                    if (layer._isSelected) {
                        if (layer.getBounds) {
                            bounds.extend(layer.getBounds());
                        } else if (layer.getLatLng) {
                            bounds.extend(layer.getLatLng());
                        }
                    }
                });
                if (bounds.isValid()) {
                    map.fitBounds(bounds, { padding: [50, 50] });
                }
            }
        }
        
        // Função para limpar seleção
        function clearSelection4() {
            // 1. Desmarca itens na listbox
            var select = document.getElementById('feature-list-4');
            Array.from(select.options).forEach(option => option.selected = false);
            
            // 2. Remove destaque no mapa
            layer4.eachLayer(function(layer) {
                layer._isSelected = false;
                if (layer.setStyle && layer._originalStyle) {
                    layer.setStyle(layer._originalStyle);
                    if (layer.setRadius) layer.setRadius(layer._originalStyle.radius);
                }
                if (layer.closePopup) layer.closePopup();
            });
        }
        
        // Evento de mudança na listbox
        document.getElementById('feature-list-4').addEventListener('change', highlightSelectedFeatures4);
        
        // Botão de limpar seleção
        document.getElementById('clear-selection-4').addEventListener('click', clearSelection4);
        
        // Camada 5: prods_25m_reproj
        var layer5 = L.geoJSON({"features":[{"geometry":{"coordinates":[-52.728039,-27.051854],"type":"Point"},"id":0,"properties":{"filiada":"Alfa","id":null,"matricula":12345,"nome":"Florisberto Antunes","x":-52.728,"y":-27.051},"type":"Feature"},{"geometry":{"coordinates":[-52.726433,-27.053838],"type":"Point"},"id":1,"properties":{"filiada":"Alfa","id":null,"matricula":4569,"nome":"Robson Crusoé","x":-52.726,"y":-27.053},"type":"Feature"},{"geometry":{"coordinates":[-52.722773,-27.055527],"type":"Point"},"id":2,"properties":{"filiada":"Alfa","id":null,"matricula":78944,"nome":"Pedro de Lara","x":-52.722,"y":-27.055},"type":"Feature"},{"geometry":{"coordinates":[-52.731218,-27.054849],"type":"Point"},"id":3,"properties":{"filiada":"Alfa","id":null,"matricula":45697,"nome":"Cristóvão Colombo","x":-52.731,"y":-27.054},"type":"Feature"},{"geometry":{"coordinates":[-52.717618,-27.057988],"type":"Point"},"id":4,"properties":{"filiada":"Alfa","id":null,"matricula":76136,"nome":"Pedro Cabral","x":-52.717,"y":-27.058},"type":"Feature"},{"geometry":{"coordinates":[-52.711569,-27.057878],"type":"Point"},"id":5,"properties":{"filiada":"Copérdia","id":null,"matricula":78312,"nome":"Joana Darc","x":-52.711,"y":-27.057},"type":"Feature"},{"geometry":{"coordinates":[-52.68641,-27.065279],"type":"Point"},"id":6,"properties":{"filiada":"Copérdia","id":null,"matricula":5612,"nome":"Carlos Alberto","x":-52.686,"y":-27.065},"type":"Feature"},{"geometry":{"coordinates":[-52.652158,-27.040008],"type":"Point"},"id":7,"properties":{"filiada":"Copérdia","id":null,"matricula":12311,"nome":"Raphael Vareiro","x":-52.652,"y":-27.04},"type":"Feature"},{"geometry":{"coordinates":[-52.602491,-27.022715],"type":"Point"},"id":8,"properties":{"filiada":"Alfa","id":null,"matricula":49715,"nome":"José de Jesus","x":-52.602,"y":-27.022},"type":"Feature"},{"geometry":{"coordinates":[-52.590795,-27.028084],"type":"Point"},"id":9,"properties":{"filiada":"Alfa","id":null,"matricula":33325,"nome":"Ivolanda Souza","x":-52.59,"y":-27.028},"type":"Feature"},{"geometry":{"coordinates":[-52.590237,-27.031413],"type":"Point"},"id":10,"properties":{"filiada":"Alfa","id":null,"matricula":7894,"nome":"Maria Azambuja","x":-52.59,"y":-27.031},"type":"Feature"},{"geometry":{"coordinates":[-52.596687,-27.026692],"type":"Point"},"id":11,"properties":{"filiada":"Alfa","id":null,"matricula":69999,"nome":"Antônia da Silva","x":-52.596,"y":-27.026},"type":"Feature"},{"geometry":{"coordinates":[-52.580535,-27.009081],"type":"Point"},"id":12,"properties":{"filiada":"Alfa","id":null,"matricula":14593,"nome":"Francisca Pedroso","x":-52.58,"y":-27.009},"type":"Feature"},{"geometry":{"coordinates":[-52.575663,-27.007966],"type":"Point"},"id":13,"properties":{"filiada":"Alfa","id":null,"matricula":21312,"nome":"Maiara Santos","x":-52.575,"y":-27.008},"type":"Feature"},{"geometry":{"coordinates":[-52.594333,-27.000714],"type":"Point"},"id":14,"properties":{"filiada":"Copérdia","id":null,"matricula":719813,"nome":"Silvio da Silva","x":-52.594,"y":-27.0},"type":"Feature"},{"geometry":{"coordinates":[-52.564692,-27.036676],"type":"Point"},"id":15,"properties":{"filiada":"Alfa","id":null,"matricula":31999,"nome":"Pedro Carlos","x":-52.564,"y":-27.036},"type":"Feature"},{"geometry":{"coordinates":[-52.551248,-27.051989],"type":"Point"},"id":16,"properties":{"filiada":"Alfa","id":null,"matricula":744489,"nome":"Alberto Albert","x":-52.551,"y":-27.052},"type":"Feature"},{"geometry":{"coordinates":[-52.563744,-27.06389],"type":"Point"},"id":17,"properties":{"filiada":"Alfa","id":null,"matricula":99874,"nome":"Cleiton Rasta","x":-52.563,"y":-27.063},"type":"Feature"},{"geometry":{"coordinates":[-52.568448,-27.078208],"type":"Point"},"id":18,"properties":{"filiada":"Alfa","id":null,"matricula":96325,"nome":"Mario Luigi","x":-52.568,"y":-27.078},"type":"Feature"},{"geometry":{"coordinates":[-52.730875,-27.181931],"type":"Point"},"id":19,"properties":{"filiada":"Copérdia","id":null,"matricula":75316,"nome":"Joberson Jobs","x":-52.73,"y":-27.181},"type":"Feature"},{"geometry":{"coordinates":[-52.729955,-27.18472],"type":"Point"},"id":20,"properties":{"filiada":"Alfa","id":null,"matricula":46821,"nome":"Camila Arruda","x":-52.73,"y":-27.184},"type":"Feature"},{"geometry":{"coordinates":[-52.777918,-27.036329],"type":"Point"},"id":21,"properties":{"filiada":"Alfa","id":null,"matricula":45564,"nome":"Paulo Jobim","x":-52.777,"y":-27.036},"type":"Feature"},{"geometry":{"coordinates":[-52.777845,-27.037045],"type":"Point"},"id":22,"properties":{"filiada":"Copérdia","id":null,"matricula":78941,"nome":"Joel Jorel","x":-52.777,"y":-27.037},"type":"Feature"},{"geometry":{"coordinates":[-52.772495,-27.018086],"type":"Point"},"id":23,"properties":{"filiada":"Alfa","id":null,"matricula":77741,"nome":"Tim de Maia","x":-52.772,"y":-27.018},"type":"Feature"},{"geometry":{"coordinates":[-52.772094,-27.025365],"type":"Point"},"id":24,"properties":{"filiada":"Alfa","id":null,"matricula":66218,"nome":"Marco Polo","x":-52.772,"y":-27.025},"type":"Feature"},{"geometry":{"coordinates":[-52.798386,-27.137932],"type":"Point"},"id":25,"properties":{"filiada":"Alfa","id":null,"matricula":1238,"nome":"MArco Antônio","x":-52.798,"y":-27.137},"type":"Feature"},{"geometry":{"coordinates":[-52.574548,-27.141416],"type":"Point"},"id":26,"properties":{"filiada":"Alfa","id":null,"matricula":78999,"nome":"Júlio Cesar","x":-52.574,"y":-27.141},"type":"Feature"},{"geometry":{"coordinates":[-52.646689,-27.202016],"type":"Point"},"id":27,"properties":{"filiada":"Copérdia","id":null,"matricula":451233,"nome":"Roberto Carlos","x":-52.646,"y":-27.202},"type":"Feature"},{"geometry":{"coordinates":[-52.746284,-26.94783],"type":"Point"},"id":28,"properties":{"filiada":"Copérdia","id":null,"matricula":210365,"nome":"Vanderlei Nogueira","x":-52.746,"y":-26.947},"type":"Feature"},{"geometry":{"coordinates":[-52.751757,-26.947751],"type":"Point"},"id":29,"properties":{"filiada":"Alfa","id":null,"matricula":384095,"nome":"Jussara Fabian","x":-52.751,"y":-26.947},"type":"Feature"},{"geometry":{"coordinates":[-52.803174,-26.976745],"type":"Point"},"id":30,"properties":{"filiada":"Copérdia","id":null,"matricula":58401,"nome":"Jandira Janesc","x":-52.803,"y":-26.976},"type":"Feature"},{"geometry":{"coordinates":[-52.792936,-27.087019],"type":"Point"},"id":31,"properties":{"filiada":"Alfa","id":null,"matricula":78955,"nome":"Gian Ferreira","x":-52.792,"y":-27.087},"type":"Feature"},{"geometry":{"coordinates":[-52.850136,-27.080491],"type":"Point"},"id":32,"properties":{"filiada":"Alfa","id":null,"matricula":45622,"nome":"Bruno Hortêncio","x":-52.85,"y":-27.08},"type":"Feature"},{"geometry":{"coordinates":[-52.677327,-26.961875],"type":"Point"},"id":33,"properties":{"filiada":"Alfa","id":null,"matricula":33321,"nome":"Jessé de Carlo","x":-52.677,"y":-26.961},"type":"Feature"},{"geometry":{"coordinates":[-52.834877,-27.20378],"type":"Point"},"id":34,"properties":{"filiada":"Copérdia","id":null,"matricula":11102,"nome":"Herbert Richards","x":-52.834,"y":-27.203},"type":"Feature"},{"geometry":{"coordinates":[-52.835771,-27.200938],"type":"Point"},"id":35,"properties":{"filiada":"Alfa","id":null,"matricula":456701,"nome":"Irineu Sobis","x":-52.835,"y":-27.2},"type":"Feature"},{"geometry":{"coordinates":[-52.834662,-27.195977],"type":"Point"},"id":36,"properties":{"filiada":"Copérdia","id":null,"matricula":99954,"nome":"Edy Harris","x":-52.834,"y":-27.196},"type":"Feature"},{"geometry":{"coordinates":[-52.726589,-26.971857],"type":"Point"},"id":37,"properties":{"filiada":"Alfa","id":null,"matricula":84458,"nome":"Franz Lindermann","x":-52.726,"y":-26.971},"type":"Feature"},{"geometry":{"coordinates":[-52.720565,-26.97145],"type":"Point"},"id":38,"properties":{"filiada":"Alfa","id":null,"matricula":32659,"nome":"ALberto Roberto","x":-52.72,"y":-26.971},"type":"Feature"},{"geometry":{"coordinates":[-52.708802,-26.970882],"type":"Point"},"id":39,"properties":{"filiada":"Alfa","id":null,"matricula":78451,"nome":"Francisco Anisio","x":-52.708,"y":-26.97},"type":"Feature"},{"geometry":{"coordinates":[-52.692334,-26.939109],"type":"Point"},"id":40,"properties":{"filiada":"Copérdia","id":null,"matricula":216574,"nome":"Tiago Hover","x":-52.692,"y":-26.939},"type":"Feature"},{"geometry":{"coordinates":[-52.8402,-27.022533],"type":"Point"},"id":41,"properties":{"filiada":"Copérdia","id":null,"matricula":326478,"nome":"Flávia Fragoso","x":-52.84,"y":-27.022},"type":"Feature"},{"geometry":{"coordinates":[-52.500247,-27.059818],"type":"Point"},"id":42,"properties":{"filiada":"Alfa","id":null,"matricula":852014,"nome":"Kelen Almeida","x":-52.5,"y":-27.059},"type":"Feature"},{"geometry":{"coordinates":[-52.511688,-27.03116],"type":"Point"},"id":43,"properties":{"filiada":"Alfa","id":null,"matricula":96635,"nome":"Lindalva Orso","x":-52.511,"y":-27.031},"type":"Feature"},{"geometry":{"coordinates":[-52.701146,-27.162595],"type":"Point"},"id":44,"properties":{"filiada":"Alfa","id":null,"matricula":254971,"nome":"Caio Lombardi","x":-52.701,"y":-27.162},"type":"Feature"},{"geometry":{"coordinates":[-52.89795,-27.059934],"type":"Point"},"id":45,"properties":{"filiada":"Copérdia","id":null,"matricula":142541,"nome":"Emival da Luz","x":-52.898,"y":-27.059},"type":"Feature"}],"type":"FeatureCollection"}, {
            style: function(feature) {
                return {
                    color: '#ff9e17',
                    weight: 2,
                    opacity: 1.0,
                    fillColor: '#ff9e17',
                    fillOpacity: 1.0
                };
            },
            
                pointToLayer: function(feature, latlng) {
                    return L.circleMarker(latlng, {
                        radius: 5.292,
                        fillColor: '#ff9e17',
                        color: '#ff9e17',
                        weight: 1,
                        opacity: 1.0,
                        fillOpacity: 1.0
                    });
                },
            onEachFeature: function(feature, layer) {
                // Verifica se existem propriedades (para GeoJSON)
                var props = feature.properties || feature;
                
                if (props) {
                    // Ordena os nomes dos atributos
                    var propNames = Object.keys(props).sort();
                    
                    // Cria conteúdo formatado no padrão atributo: valor (um por linha)
                    var content = "<div style='font-family: Arial;'>";
                    for (var i = 0; i < propNames.length; i++) {
                        var prop = propNames[i];
                        var value = props[prop] !== null && props[prop] !== undefined ? props[prop] : '';
                        content += "<b>" + prop + "</b>: " + value + "<br>";
                    }
                    content += "</div>";
                    
                    // Adiciona popup ao clicar
                    layer.bindPopup(content);
                    
                    // Armazena o valor do atributo selecionado (se houver)
                    if ('matricula' && props['matricula'] !== undefined) {
                        layer.featureAttrValue = String(props['matricula']);
                    }
                    
                    // Armazena o estilo original
                    layer._originalStyle = {
                        color: '#ff9e17',
                        weight: 2,
                        opacity: 1.0,
                        fillColor: '#ff9e17',
                        fillOpacity: 1.0,
                        radius: 5.292
                    };
                    
                    // Armazena se está selecionado
                    layer._isSelected = false;
                }
            }
        });
        
        // Adiciona a camada ao mapa
        layer5.addTo(map);
        
        // Controle da camada 5
        document.getElementById('layer-checkbox-5').addEventListener('change', function(e) {
            if (e.target.checked) {
                layer5.addTo(map);
            } else {
                map.removeLayer(layer5);
            }
            reorderLayers();
        });
        // Função para destacar features selecionadas 5
        function highlightSelectedFeatures5() {
            var select = document.getElementById('feature-list-5');
            var selectedValues = Array.from(select.selectedOptions).map(option => option.value);
            
            layer5.eachLayer(function(layer) {
                // Verifica se o layer está na seleção
                var isSelected = layer.featureAttrValue && selectedValues.includes(layer.featureAttrValue);
                
                // Atualiza o estado de seleção
                layer._isSelected = isSelected;
                
                if (isSelected) {
                    // Aplica estilo de seleção
                    var highlightStyle = {
                        color: '#ff0000',
                        weight: 4,
                        opacity: 1,
                        fillColor: '#ff0000',
                        fillOpacity: 0.8
                    };
                    if (layer.setStyle) {
                        layer.setStyle(highlightStyle);
                    }
                    if (layer.setRadius) {
                        layer.setRadius(7.292);
                    }
                } else {
                    // Volta ao estilo original
                    if (layer.setStyle && layer._originalStyle) {
                        layer.setStyle(layer._originalStyle);
                    }
                    if (layer.setRadius && layer._originalStyle) {
                        layer.setRadius(layer._originalStyle.radius);
                    }
                }
            });
            
            // Ajusta o zoom para os selecionados
            if (selectedValues.length > 0) {
                var bounds = new L.LatLngBounds();
                layer5.eachLayer(function(layer) {
                    if (layer._isSelected) {
                        if (layer.getBounds) {
                            bounds.extend(layer.getBounds());
                        } else if (layer.getLatLng) {
                            bounds.extend(layer.getLatLng());
                        }
                    }
                });
                if (bounds.isValid()) {
                    map.fitBounds(bounds, { padding: [50, 50] });
                }
            }
        }
        
        // Função para limpar seleção
        function clearSelection5() {
            // 1. Desmarca itens na listbox
            var select = document.getElementById('feature-list-5');
            Array.from(select.options).forEach(option => option.selected = false);
            
            // 2. Remove destaque no mapa
            layer5.eachLayer(function(layer) {
                layer._isSelected = false;
                if (layer.setStyle && layer._originalStyle) {
                    layer.setStyle(layer._originalStyle);
                    if (layer.setRadius) layer.setRadius(layer._originalStyle.radius);
                }
                if (layer.closePopup) layer.closePopup();
            });
        }
        
        // Evento de mudança na listbox
        document.getElementById('feature-list-5').addEventListener('change', highlightSelectedFeatures5);
        
        // Botão de limpar seleção
        document.getElementById('clear-selection-5').addEventListener('click', clearSelection5);
        
        
        // Define a ordem de sobreposição das camadas (primeira na lista = topo)
        var layersOrder = [];
layersOrder.push(layer0);
layersOrder.push(layer1);
layersOrder.push(layer2);
layersOrder.push(layer3);
layersOrder.push(layer4);
layersOrder.push(layer5);

        
        
        // Função para reordenar as camadas mantendo a ordem original
        function reorderLayers() {
            // Remove todas as camadas (exceto baseLayer se existir)
            layersOrder.forEach(function(layer) {
                if (map.hasLayer(layer)) {
                    map.removeLayer(layer);
                }
            });
            
            // Adiciona novamente na ordem correta
            layersOrder.forEach(function(layer) {
                var checkbox = document.getElementById('layer-checkbox-' + layersOrder.indexOf(layer));
                if (checkbox && checkbox.checked) {
                    layer.addTo(map);
                }
            });
        }
        
        
        // Ajusta o zoom para mostrar todas as camadas
        var bounds = L.latLngBounds();
        bounds.extend(layer0.getBounds());bounds.extend(layer1.getBounds());bounds.extend(layer2.getBounds());bounds.extend(layer3.getBounds());bounds.extend(layer4.getBounds());bounds.extend(layer5.getBounds());
        if (bounds.isValid()) {
            map.fitBounds(bounds);
        }
        
        // Adiciona filtros para as camadas que têm lista
        
        // Filtro para camada 3
        document.getElementById('filter-3').addEventListener('input', function(e) {
            var filter = this.value.toLowerCase();
            var options = document.getElementById('feature-list-3').options;
            
            for (var j = 0; j < options.length; j++) {
                options[j].style.display = options[j].text.toLowerCase().includes(filter) ? '' : 'none';
            }
        });
        
        // Filtro para camada 4
        document.getElementById('filter-4').addEventListener('input', function(e) {
            var filter = this.value.toLowerCase();
            var options = document.getElementById('feature-list-4').options;
            
            for (var j = 0; j < options.length; j++) {
                options[j].style.display = options[j].text.toLowerCase().includes(filter) ? '' : 'none';
            }
        });
        
        // Filtro para camada 5
        document.getElementById('filter-5').addEventListener('input', function(e) {
            var filter = this.value.toLowerCase();
            var options = document.getElementById('feature-list-5').options;
            
            for (var j = 0; j < options.length; j++) {
                options[j].style.display = options[j].text.toLowerCase().includes(filter) ? '' : 'none';
            }
        });
        
    </script>
</body>
</html>